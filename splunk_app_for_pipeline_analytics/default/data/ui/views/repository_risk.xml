
        <dashboard version="2" theme="dark" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
            <label>Overall Security Risk</label>
            <description></description>
            <definition><![CDATA[{"dataSources":{"ds_pyag8AXY":{"type":"ds.search","options":{"query":"| pivot Code_Vulnerabilities Vulnerabilities count(Vulnerabilities) AS \"Count of Dependency Vulnerabilities\" SPLITROW signature AS signature SPLITROW organization AS organization FILTER organization is \"$orgTkn$\" SPLITROW repository_name AS repository_name FILTER repository_name is \"$repoTkn$\"\n| stats count(signature) as count"},"name":"Vulnerability_Count"},"ds_7etCBLX4":{"type":"ds.search","options":{"query":"index=github_webhook organization=\"$orgTkn$\" repository_name=\"$repoTkn$\" (eventtype=\"GitHub::VulnerabilityAlert\" OR eventtype=\"GitHub::VulnerabilityAlert\")| eval severity_id=if(severity==\"critical\",4, if(severity==\"high\",3, if(severity==\"moderate\",2,1))) | stats max(severity_id) as maxSev | eval severity=if(maxSev==4,\"critical\", if(maxSev==3,\"high\", if(maxSev==2,\"moderate\",\"low\"))) "},"name":"Search_2"},"ds_kjY2Au06":{"type":"ds.search","options":{"query":"index=github_webhook organization=\"$orgTkn$\" repository_name=\"$repoTkn$\" (eventtype=\"GitHub::VulnerabilityAlert\" OR eventtype=\"GitHub::VulnerabilityAlert\")| eval severity_id=if(severity==\"critical\",4, if(severity==\"high\",3, if(severity==\"moderate\",2,1))) | stats median(severity_id) as medSev| eval severity=if(medSev==4,\"critical\", if(medSev==3,\"high\", if(medSev==2,\"moderate\",\"low\")))"},"name":"Search_3"},"ds_g8zncGoe":{"type":"ds.search","options":{"query":"| inputlookup append=t repo_meta_data | search organization=\"$orgTkn$\" repository=\"$repoTkn$\" | sort class | head 1"},"name":"Profile Score"},"ds_GCwCfUNu":{"type":"ds.search","options":{"query":"| datamodel Change All_Changes search | search All_Changes.object_category=\"repository\" All_Changes.dest=\"$orgTkn$\" All_Changes.object=\"$repoTkn$\" NOT All_Changes.change_type IN(\"git\",\"workflows\",\"pull_request\")\n| timechart count | fillnull \n| accum count"},"name":"Get Changes"},"ds_7fT7ZZJU":{"type":"ds.search","options":{"query":"index=notable repo=\"$orgTkn$/$repoTkn$\" | timechart count | accum count"},"name":"User Activities"},"ds_dZRub5im":{"type":"ds.chain","options":{"extend":"ds_pyag8AXY","query":"eval RiskScore=((TotalCount+100+50)*10)+(6*23) \n|  fields RiskScore"},"name":"Search_7"},"ds_vHYMMGNj":{"type":"ds.chain","options":{"extend":"ds_dZRub5im","query":"eval RiskName=if(RiskScore>5000,\"Critical\",if(RiskScore>3000,\"High\",if(RiskScore>2000, \"Moderate\",\"Normal\"))) \n"},"name":"Search_8"},"ds_yRa2lx0l":{"type":"ds.search","options":{"query":"| makeresults \n|  eval repoName=\"$orgTkn$/$repoTkn$\""},"name":"Search_9"},"ds_9ncqzGH0_ds_GCwCfUNu":{"type":"ds.search","options":{"query":"index=notable repo=\"$orgTkn$/$repoTkn$\" | timechart count"},"name":"Get Notables Events"},"ds_UXDMJl7l_ds_pyag8AXY":{"type":"ds.search","options":{"query":"| pivot Code_Vulnerabilities Coding_Vulnerabilities count(Coding_Vulnerabilities) AS \"Count of Coding Vulnerabilities\" SPLITROW signature AS signature SPLITROW organization AS organization FILTER organization is \"$orgTkn$\" SPLITROW repository_name AS repository_name FILTER repository_name is \"$repoTkn$\" \n| stats dc(signature) as count"},"name":"CodingVulnerability"},"ds_fi8icGi4":{"type":"ds.search","options":{"query":"index=risk risk_object_type=system repo=\"$orgTkn$/$repoTkn$\"\n| stats sum(risk_score) as risk"},"name":"Get Total Risk"},"ds_2YGryH7a_ds_fi8icGi4":{"type":"ds.search","options":{"query":"index=risk risk_object_type=user repo=\"$orgTkn$/$repoTkn$\"\n| stats sum(risk_score) as risk"},"name":"Get User Risk"},"ds_xugeZbyY":{"type":"ds.search","options":{"query":"| datamodel DevOps_Code DevOps_Commit search | dedup DevOps_Commit.repository_name, DevOps_Commit.repository_organization | table DevOps_Commit.repository_organization"},"name":"List Orgs"},"ds_fS9unEHI":{"type":"ds.search","options":{"query":"| datamodel DevOps_Code DevOps_Commit search | search DevOps_Commit.repository_organization=\"$orgTkn$\" \n|  dedup DevOps_Commit.repository_name | table DevOps_Commit.repository_name"},"name":"List Repos"},"ds_wl9M2x5P":{"type":"ds.search","options":{"query":"| pivot Code_Vulnerabilities Vulnerabilities count(signature) AS \"count\" SPLITROW severity AS severity SPLITROW organization AS organization FILTER organization is \"$orgTkn$\" SPLITROW repository_name AS repository_name FILTER repository_name is \"$repoTkn$\" SPLITROW category as category SPLITROW severity_id AS severity_id\n| append [| pivot Code_Vulnerabilities Coding_Vulnerabilities count(signature) AS \"count\" SPLITROW severity AS severity SPLITROW organization AS organization FILTER organization is \"$orgTkn$\" SPLITROW repository_name AS repository_name FILTER repository_name is \"$repoTkn$\" SPLITROW category as category SPLITROW severity_id AS severity_id]"},"name":"List Severities"},"ds_NgnawGmW":{"type":"ds.chain","options":{"extend":"ds_wl9M2x5P","query":"| fillnull\n| stats max(severity_id) as max_severity\n| eval max_severity=case(max_severity==4,\"critical\",max_severity==3,\"high\",max_severity==2,\"moderate\",max_severity==1,\"low\", true=true, \"None\")\n"},"name":"Max Severity"},"ds_mf2VcxN0":{"type":"ds.chain","options":{"extend":"ds_wl9M2x5P","query":"| stats sum(count) as total by severity_id | sort -total | head 1 | eval severity_value=case(severity_id==4,\"critical\",severity_id==3,\"high\",severity_id==2,\"moderate\",severity_id==1,\"low\")"},"name":"Common Severity"}},"inputs":{"input_global_trp":{"type":"input.timerange","options":{"token":"global_time","defaultValue":"-30d@d,now"},"title":"Global Time Range"},"input_KGELdd3b":{"options":{"items":">frame(label, value) | prepend(formattedStatics) | objects()","defaultValue":"*","token":"repoTkn"},"title":"Repository","type":"input.dropdown","dataSources":{"primary":"ds_fS9unEHI"},"context":{"formattedConfig":{"number":{"prefix":""}},"formattedStatics":">statics | formatByType(formattedConfig)","statics":[["All"],["*"]],"label":">primary | seriesByName(\"DevOps_Commit.repository_name\") | renameSeries(\"label\") | formatByType(formattedConfig)","value":">primary | seriesByName(\"DevOps_Commit.repository_name\") | renameSeries(\"value\") | formatByType(formattedConfig)"}},"input_pFxr0gst":{"options":{"items":">frame(label, value) | prepend(formattedStatics) | objects()","defaultValue":"*","token":"orgTkn"},"title":"Organization","type":"input.dropdown","dataSources":{"primary":"ds_xugeZbyY"},"context":{"formattedConfig":{"number":{"prefix":""}},"formattedStatics":">statics | formatByType(formattedConfig)","statics":[["All"],["*"]],"label":">primary | seriesByName(\"DevOps_Commit.repository_organization\") | renameSeries(\"label\") | formatByType(formattedConfig)","value":">primary | seriesByName(\"DevOps_Commit.repository_organization\") | renameSeries(\"value\") | formatByType(formattedConfig)"}}},"layout":{"type":"absolute","options":{"display":"auto-scale","backgroundColor":"transparent"},"structure":[{"item":"viz_0x5uOqXF","type":"line","position":{"from":{"x":809,"y":255},"to":{"x":810,"y":463}}},{"item":"viz_G6Y1Qyov","type":"line","position":{"from":{"x":809,"y":257},"to":{"x":880,"y":255}}},{"item":"viz_THfH7PKX","type":"line","position":{"from":{"x":810,"y":366},"to":{"x":880,"y":365}}},{"item":"viz_a92vGs7W","type":"line","position":{"from":{"x":781,"y":366},"to":{"x":810,"y":366}}},{"item":"viz_J2EawSMR","type":"line","position":{"from":{"x":390,"y":366},"to":{"x":419,"y":366}}},{"item":"viz_VyrplOLt","type":"block","position":{"x":420,"y":190,"w":360,"h":360}},{"item":"viz_KdHBREhz","type":"block","position":{"x":510,"y":120,"w":180,"h":60}},{"item":"viz_dSU7t6Tc","type":"block","position":{"x":850,"y":110,"w":310,"h":460}},{"item":"viz_d3Dbzjps","type":"block","position":{"x":10,"y":110,"w":310,"h":470}},{"item":"viz_BX1MkRG0","type":"block","position":{"x":40,"y":170,"w":120,"h":90}},{"item":"viz_2OnYzRA4","type":"block","position":{"x":40,"y":270,"w":250,"h":90}},{"item":"viz_GzWTViP4","type":"block","position":{"x":40,"y":370,"w":250,"h":90}},{"item":"viz_xRgBhhyq","type":"block","position":{"x":40,"y":470,"w":250,"h":90}},{"item":"viz_uKdwfez3","type":"block","position":{"x":480,"y":260,"w":250,"h":110}},{"item":"viz_uU1I40UI","type":"block","position":{"x":540,"y":130,"w":270,"h":80}},{"item":"viz_BtlBgryP","type":"block","position":{"x":250,"y":0,"w":720,"h":110}},{"item":"viz_ZOynNneU","type":"block","position":{"x":50,"y":120,"w":50,"h":40}},{"item":"viz_G7lDWu79","type":"block","position":{"x":110,"y":120,"w":110,"h":40}},{"item":"viz_I6WvbyVX","type":"block","position":{"x":880,"y":120,"w":40,"h":40}},{"item":"viz_3kwFtKEr","type":"block","position":{"x":930,"y":120,"w":110,"h":40}},{"item":"viz_IYCoQm2g","type":"line","position":{"from":{"x":390,"y":212},"to":{"x":389,"y":517}}},{"item":"viz_ssMrK9up","type":"line","position":{"from":{"x":389,"y":214},"to":{"x":293,"y":216}}},{"item":"viz_w3GvwMWo","type":"line","position":{"from":{"x":388,"y":313},"to":{"item":"viz_2OnYzRA4","port":"e"}}},{"item":"viz_7L8760uY","type":"line","position":{"from":{"x":389,"y":414},"to":{"item":"viz_GzWTViP4","port":"e"}}},{"item":"viz_MtWSHYpf","type":"line","position":{"from":{"x":389,"y":517},"to":{"x":289,"y":518}}},{"item":"viz_CoIUD7ZL","type":"block","position":{"x":880,"y":410,"w":250,"h":90}},{"item":"viz_x8Yxo4Lh","type":"line","position":{"from":{"x":810,"y":462},"to":{"x":880,"y":462}}},{"item":"viz_9CMf6PGY","type":"block","position":{"x":880,"y":210,"w":250,"h":90}},{"item":"viz_GIBpxkgR","type":"block","position":{"x":880,"y":310,"w":250,"h":90}},{"item":"viz_gZFHy4RR","type":"block","position":{"x":170,"y":170,"w":120,"h":90}},{"item":"viz_hasmKsVC","type":"block","position":{"x":480,"y":380,"w":250,"h":110}}],"globalInputs":["input_pFxr0gst","input_KGELdd3b","input_global_trp"]},"description":"","title":"Overall Security Risk","defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{"latest":"$global_time.latest$","earliest":"$global_time.earliest$"}}}}},"visualizations":{"viz_BX1MkRG0":{"type":"splunk.singlevalue","options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('count')","sparklineDisplay":"before","majorColor":"> majorValue | rangeValue(majorColorEditorConfig)","unitPosition":"before"},"dataSources":{"primary":"ds_pyag8AXY"},"context":{"majorColorEditorConfig":[{"value":"#118832","to":10},{"value":"#cba700","from":10,"to":30},{"value":"#d97a0d","from":30,"to":60},{"value":"#d94e17","from":60,"to":80},{"value":"#d41f1f","from":80}]},"title":"Dependency"},"viz_2OnYzRA4":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_NgnawGmW"},"title":"Maximum Severity","context":{"majorColorEditorConfig":[{"to":20,"value":"#D41F1F"},{"from":20,"to":40,"value":"#D94E17"},{"from":40,"to":60,"value":"#CBA700"},{"from":60,"to":80,"value":"#669922"},{"from":80,"value":"#118832"}]},"showProgressBar":false,"showLastUpdated":false,"options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('max_severity')","queryParameters":{"latest":"$global_time.latest$","earliest":"$global_time.earliest$"}}},"viz_GzWTViP4":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_mf2VcxN0"},"title":"Most Common Severity","options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('severity_value')","queryParameters":{"latest":"$global_time.latest$","earliest":"$global_time.earliest$"}}},"viz_xRgBhhyq":{"type":"splunk.singlevalue","dataSources":{"primary":"ds_g8zncGoe"},"title":"Profile Score","options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('class')","unitPosition":"before","unit":""}},"viz_VyrplOLt":{"type":"splunk.ellipse","dataSources":{"primary":"ds_dZRub5im"},"options":{"fillColor":"> primary | seriesByIndex(0) | rangeValue(fillRangeValueContext) | lastPoint()"},"context":{"fillRangeValueContext":[{"from":5000,"value":"#cb3b43"},{"from":3000,"value":"#ff7152","to":5000},{"from":1000,"value":"#fc9850","to":3000},{"value":"#53a051","to":1000}]}},"viz_uKdwfez3":{"type":"splunk.singlevalue","options":{"sparklineDisplay":"off","majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('risk')","backgroundColor":"> majorValue | rangeValue(backgroundColorEditorConfig)"},"dataSources":{"primary":"ds_fi8icGi4"},"context":{"backgroundColorEditorConfig":[{"value":"#118832","to":2000},{"value":"#D97A0D","from":2000,"to":7000},{"value":"#d94e17","from":7000,"to":10000},{"value":"#d41f1f","from":10000}]},"title":"System Risk"},"viz_uU1I40UI":{"options":{"markdown":"# Risk Score"},"type":"splunk.markdown","context":{}},"viz_BtlBgryP":{"type":"splunk.singlevalue","options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('repoName')","backgroundColor":"transparent"},"dataSources":{"primary":"ds_yRa2lx0l"}},"viz_d3Dbzjps":{"type":"splunk.rectangle","options":{"fillColor":"#31373e","rx":5}},"viz_ZOynNneU":{"type":"splunk.singlevalueicon","options":{"showValue":false,"icon":"splunk-enterprise-kvstore://icon-firewall__037c3797-3676-4b94-aa5f-01293cafab69.svg"}},"viz_G7lDWu79":{"type":"splunk.markdown","options":{"markdown":"Risk Profile"}},"viz_dSU7t6Tc":{"type":"splunk.rectangle","options":{"fillColor":"#31373e","rx":5}},"viz_KdHBREhz":{"type":"splunk.rectangle"},"viz_0x5uOqXF":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_G6Y1Qyov":{"type":"abslayout.line","options":{"strokeWidth":3,"toArrow":true}},"viz_THfH7PKX":{"type":"abslayout.line","options":{"toArrow":true,"strokeWidth":3}},"viz_a92vGs7W":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_I6WvbyVX":{"type":"splunk.singlevalueicon","options":{"showValue":false,"icon":"splunk-enterprise-kvstore://icon-active-directory__e03b60f5-d599-485e-bc89-67b86f2f80c7.svg"}},"viz_3kwFtKEr":{"type":"splunk.markdown","options":{"markdown":"Events"}},"viz_J2EawSMR":{"type":"abslayout.line","options":{"strokeWidth":3,"toArrow":true}},"viz_IYCoQm2g":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_ssMrK9up":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_w3GvwMWo":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_7L8760uY":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_MtWSHYpf":{"type":"abslayout.line","options":{"strokeWidth":3}},"viz_CoIUD7ZL":{"type":"splunk.singlevalue","title":"Notable Events","dataSources":{"primary":"ds_9ncqzGH0_ds_GCwCfUNu"},"options":{"sparklineDisplay":"after"}},"viz_x8Yxo4Lh":{"type":"abslayout.line","options":{"toArrow":true,"strokeWidth":3}},"viz_9CMf6PGY":{"type":"splunk.singlevalue","title":"Suspicious User Activity","dataSources":{"primary":"ds_7fT7ZZJU"},"options":{"sparklineDisplay":"after"}},"viz_GIBpxkgR":{"type":"splunk.singlevalue","title":"Configuration Changes","dataSources":{"primary":"ds_GCwCfUNu"},"options":{"sparklineDisplay":"after"}},"viz_gZFHy4RR":{"type":"splunk.singlevalue","options":{"majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('count')","sparklineDisplay":"before","majorColor":"> majorValue | rangeValue(majorColorEditorConfig)","unitPosition":"before"},"dataSources":{"primary":"ds_UXDMJl7l_ds_pyag8AXY"},"context":{"majorColorEditorConfig":[{"to":20,"value":"#D41F1F"},{"from":20,"to":40,"value":"#D94E17"},{"from":40,"to":60,"value":"#CBA700"},{"from":60,"to":80,"value":"#669922"},{"from":80,"value":"#118832"}]},"title":"Code Vulns"},"viz_hasmKsVC":{"type":"splunk.singlevalue","options":{"sparklineDisplay":"off","majorValue":"> sparklineValues | lastPoint()","trendValue":"> sparklineValues | delta(-2)","sparklineValues":"> primary | seriesByName('risk')","backgroundColor":"> majorValue | rangeValue(backgroundColorEditorConfig)"},"dataSources":{"primary":"ds_2YGryH7a_ds_fi8icGi4"},"context":{"backgroundColorEditorConfig":[{"value":"#118832","to":3000},{"value":"#D97A0D","from":3000,"to":4000},{"value":"#d94e17","from":4000,"to":5000},{"value":"#d41f1f","from":5000}]},"title":"User Risk"}}}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>